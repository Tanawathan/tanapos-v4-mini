# **TableStatus 系統：定義與規則**

## **1\. 系統目標**

**TableStatus 系統** 的核心目標是提供一個即時、準確的餐廳內所有桌位的狀態視圖。此系統旨在優化座位安排效率、縮短顧客等待時間，並確保桌位翻新流程的順暢，最終提升整體營運效率與顧客滿意度。

## **2\. 桌位資料結構**

系統中的每一個「桌位 (Table)」物件都包含以下基本資訊，以便進行追蹤與管理：

* **桌位ID (tableId):** 一個獨一無二的內部識別碼，用於系統辨識。  
* **桌位名稱 (tableName):** 一個方便人員辨識的名稱，例如「A1」、「B2」或「窗邊四人桌」。  
* **容納人數 (capacity):** 此桌位可容納的最大顧客數量。  
* **目前狀態 (status):** 描述桌位當前情況的關鍵指標。這是系統的核心。  
* **關聯訂單ID (currentOrderId):** 當桌位處於用餐或結帳狀態時，關聯的訂單號碼。  
* **最後活動時間 (lastActivityTime):** 記錄狀態變更的時間戳，用於計算用餐時長或閒置時間。

## **3\. 桌位狀態定義**

每個桌位在任何時間點都只會有以下其中一種狀態：

* **🟢 空桌 (Available):**  
  * **定義:** 桌位已清理乾淨，隨時可以接待新顧客。  
  * **規則:** 這是新顧客入座的唯一有效起始狀態（預約除外）。  
* **🟡 已入座 (Seated):**  
  * **定義:** 顧客已被帶到座位，但尚未完成點餐。  
  * **規則:** 此狀態下，服務人員應上前提供菜單並協助點餐。  
* **🔵 用餐中 (Dining):**  
  * **定義:** 顧客已完成點餐，訂單已送至廚房 (KDS)。  
  * **規則:** 系統會開始計時，以追蹤用餐時間。服務人員應關注顧客需求，例如加水或加點。  
* **🟠 待付款 (Payment-Pending):**  
  * **定義:** 顧客已用完餐，並請求結帳。  
  * **規則:** POS 系統應準備好該桌的帳單，服務人員需前往處理結帳事宜。  
* **🔴 待清理 (Cleaning):**  
  * **定義:** 顧客已付款並離席，桌位正等待清潔人員整理。  
  * **規則:** 此狀態的桌位不能安排新顧客。清潔人員應盡快處理。  
* **🟣 預約中 (Reserved):**  
  * **定義:** 此桌位已被特定時間的預約所保留。  
  * **規則:** 在預約時間前後的一段緩衝時間內，此桌位不可安排給現場顧客。

## **4\. 狀態轉換規則 (SOP)**

桌位狀態的改變必須嚴格遵循以下流程，任何一個步驟的觸發都會自動更新桌位的狀態：

1. **接待入座:**  
   * 流程: 🟢 空桌 ➔ 🟡 已入座  
   * 觸發動作: 服務人員在系統上將顧客安排至某個空桌。  
2. **完成點餐:**  
   * 流程: 🟡 已入座 ➔ 🔵 用餐中  
   * 觸發動作: 在 POS 系統為該桌送出第一筆訂單。  
3. **請求結帳:**  
   * 流程: 🔵 用餐中 ➔ 🟠 待付款  
   * 觸發動作: 顧客提出結帳需求，服務人員在系統上點擊「結帳」按鈕。  
4. **完成付款:**  
   * 流程: 🟠 待付款 ➔ 🔴 待清理  
   * 觸發動作: POS 系統確認該桌訂單的款項已結清。  
5. **清理完畢:**  
   * 流程: 🔴 待清理 ➔ 🟢 空桌  
   * 觸發動作: 清潔人員完成桌面整理後，在系統上將桌位標記為「已清潔」。  
6. **處理預約:**  
   * 流程: 🟢 空桌 ➔ 🟣 預約中  
   * 觸發動作: 系統接收到新的訂位請求並成功分配桌位。  
   * 流程: 🟣 預約中 ➔ 🟡 已入座  
   * 觸發動作: 預約的顧客到場，服務人員在系統上確認並帶位。