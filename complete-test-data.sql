-- TanaPOS v4 AI - 完整測試資料 SQL 載入腳本
-- 適用於 Supabase SQL 編輯器直接執行

-- 清理現有測試資料
DELETE FROM order_items WHERE order_id IN (
  SELECT id FROM orders WHERE restaurant_id = '11111111-1111-1111-1111-111111111111'
);
DELETE FROM orders WHERE restaurant_id = '11111111-1111-1111-1111-111111111111';
DELETE FROM products WHERE restaurant_id = '11111111-1111-1111-1111-111111111111';
DELETE FROM categories WHERE restaurant_id = '11111111-1111-1111-1111-111111111111';
DELETE FROM tables WHERE restaurant_id = '11111111-1111-1111-1111-111111111111';
DELETE FROM restaurants WHERE id = '11111111-1111-1111-1111-111111111111';

-- 1. 插入餐廳資料
INSERT INTO restaurants (
  id, name, address, phone, email, tax_rate, currency, timezone, 
  created_at, updated_at
) VALUES (
  '11111111-1111-1111-1111-111111111111',
  'TanaPOS 示範餐廳',
  '台北市信義區信義路五段7號',
  '02-1234-5678',
  'demo@tanapos.com',
  0.05,
  'TWD',
  'Asia/Taipei',
  NOW(),
  NOW()
);

-- 2. 插入分類資料
INSERT INTO categories (
  id, restaurant_id, name, description, sort_order, color, icon, 
  is_active, created_at, updated_at
) VALUES 
  ('cat-1111-1111-1111-111111111111', '11111111-1111-1111-1111-111111111111', '主餐', '主要餐點', 1, '#3B82F6', '🍽️', true, NOW(), NOW()),
  ('cat-2222-2222-2222-222222222222', '11111111-1111-1111-1111-111111111111', '飲品', '各式飲品', 2, '#10B981', '🥤', true, NOW(), NOW()),
  ('cat-3333-3333-3333-333333333333', '11111111-1111-1111-1111-111111111111', '甜點', '精緻甜點', 3, '#F59E0B', '🍰', true, NOW(), NOW()),
  ('cat-4444-4444-4444-444444444444', '11111111-1111-1111-1111-111111111111', '前菜', '開胃小菜', 4, '#EF4444', '🥗', true, NOW(), NOW()),
  ('cat-5555-5555-5555-555555555555', '11111111-1111-1111-1111-111111111111', '湯品', '暖心湯品', 5, '#8B5CF6', '🍲', true, NOW(), NOW());

-- 3. 插入產品資料
INSERT INTO products (
  id, restaurant_id, category_id, name, description, price, cost, 
  preparation_time, is_available, created_at, updated_at
) VALUES 
  -- 主餐
  ('prod-1111-1111-1111-111111111111', '11111111-1111-1111-1111-111111111111', 'cat-1111-1111-1111-111111111111', '招牌牛肉麵', '經典台式牛肉麵，湯頭濃郁', 180.00, 80.00, 15, true, NOW(), NOW()),
  ('prod-2222-2222-2222-222222222222', '11111111-1111-1111-1111-111111111111', 'cat-1111-1111-1111-111111111111', '滷肉飯', '傳統台式滷肉飯', 80.00, 35.00, 8, true, NOW(), NOW()),
  ('prod-3333-3333-3333-333333333333', '11111111-1111-1111-1111-111111111111', 'cat-1111-1111-1111-111111111111', '炒飯', '香噴噴炒飯', 120.00, 50.00, 12, true, NOW(), NOW()),
  ('prod-0001-0001-0001-000000000001', '11111111-1111-1111-1111-111111111111', 'cat-1111-1111-1111-111111111111', '宮保雞丁', '經典川菜宮保雞丁', 150.00, 65.00, 12, true, NOW(), NOW()),
  ('prod-0002-0002-0002-000000000002', '11111111-1111-1111-1111-111111111111', 'cat-1111-1111-1111-111111111111', '糖醋排骨', '酸甜糖醋排骨', 160.00, 70.00, 18, true, NOW(), NOW()),
  
  -- 飲品
  ('prod-4444-4444-4444-444444444444', '11111111-1111-1111-1111-111111111111', 'cat-2222-2222-2222-222222222222', '古早味紅茶', '香濃古早味紅茶', 30.00, 8.00, 3, true, NOW(), NOW()),
  ('prod-5555-5555-5555-555555555555', '11111111-1111-1111-1111-111111111111', 'cat-2222-2222-2222-222222222222', '檸檬汽水', '清爽檸檬汽水', 40.00, 12.00, 2, true, NOW(), NOW()),
  ('prod-0003-0003-0003-000000000003', '11111111-1111-1111-1111-111111111111', 'cat-2222-2222-2222-222222222222', '珍珠奶茶', '經典珍珠奶茶', 55.00, 18.00, 5, true, NOW(), NOW()),
  ('prod-0004-0004-0004-000000000004', '11111111-1111-1111-1111-111111111111', 'cat-2222-2222-2222-222222222222', '冰咖啡', '香醇冰咖啡', 65.00, 20.00, 4, true, NOW(), NOW()),
  
  -- 甜點
  ('prod-6666-6666-6666-666666666666', '11111111-1111-1111-1111-111111111111', 'cat-3333-3333-3333-333333333333', '巧克力蛋糕', '濃郁巧克力蛋糕', 120.00, 45.00, 5, true, NOW(), NOW()),
  ('prod-0005-0005-0005-000000000005', '11111111-1111-1111-1111-111111111111', 'cat-3333-3333-3333-333333333333', '草莓蛋糕', '新鮮草莓蛋糕', 130.00, 50.00, 5, true, NOW(), NOW()),
  ('prod-0006-0006-0006-000000000006', '11111111-1111-1111-1111-111111111111', 'cat-3333-3333-3333-333333333333', '提拉米蘇', '義式提拉米蘇', 140.00, 55.00, 3, true, NOW(), NOW()),
  
  -- 前菜
  ('prod-7777-7777-7777-777777777777', '11111111-1111-1111-1111-111111111111', 'cat-4444-4444-4444-444444444444', '涼拌小黃瓜', '清爽涼拌小黃瓜', 60.00, 20.00, 5, true, NOW(), NOW()),
  ('prod-0007-0007-0007-000000000007', '11111111-1111-1111-1111-111111111111', 'cat-4444-4444-4444-444444444444', '皮蛋豆腐', '經典皮蛋豆腐', 80.00, 25.00, 5, true, NOW(), NOW()),
  ('prod-0008-0008-0008-000000000008', '11111111-1111-1111-1111-111111111111', 'cat-4444-4444-4444-444444444444', '涼拌海帶絲', '爽脆涼拌海帶絲', 70.00, 22.00, 5, true, NOW(), NOW()),
  
  -- 湯品
  ('prod-0009-0009-0009-000000000009', '11111111-1111-1111-1111-111111111111', 'cat-5555-5555-5555-555555555555', '酸辣湯', '經典酸辣湯', 60.00, 18.00, 8, true, NOW(), NOW()),
  ('prod-0010-0010-0010-000000000010', '11111111-1111-1111-1111-111111111111', 'cat-5555-5555-5555-555555555555', '玉米濃湯', '香濃玉米濃湯', 50.00, 15.00, 6, true, NOW(), NOW()),
  ('prod-0011-0011-0011-000000000011', '11111111-1111-1111-1111-111111111111', 'cat-5555-5555-5555-555555555555', '蛤蜊湯', '鮮美蛤蜊湯', 90.00, 35.00, 10, true, NOW(), NOW());

-- 4. 插入桌台資料
INSERT INTO tables (
  id, restaurant_id, table_number, name, capacity, status, 
  created_at, updated_at
) VALUES 
  ('table-1111-1111-1111-111111111111', '11111111-1111-1111-1111-111111111111', 1, 'A01', 4, 'available', NOW(), NOW()),
  ('table-2222-2222-2222-222222222222', '11111111-1111-1111-1111-111111111111', 2, 'A02', 4, 'available', NOW(), NOW()),
  ('table-3333-3333-3333-333333333333', '11111111-1111-1111-1111-111111111111', 3, 'A03', 6, 'occupied', NOW(), NOW()),
  ('table-4444-4444-4444-444444444444', '11111111-1111-1111-1111-111111111111', 4, 'B01', 2, 'available', NOW(), NOW()),
  ('table-5555-5555-5555-555555555555', '11111111-1111-1111-1111-111111111111', 5, 'B02', 4, 'cleaning', NOW(), NOW()),
  ('table-6666-6666-6666-666666666666', '11111111-1111-1111-1111-111111111111', 6, 'B03', 8, 'available', NOW(), NOW()),
  ('table-7777-7777-7777-777777777777', '11111111-1111-1111-1111-111111111111', 7, 'C01', 4, 'available', NOW(), NOW()),
  ('table-8888-8888-8888-888888888888', '11111111-1111-1111-1111-111111111111', 8, 'C02', 6, 'available', NOW(), NOW());

-- 5. 插入範例訂單
INSERT INTO orders (
  id, restaurant_id, table_id, order_number, customer_name, customer_phone,
  subtotal, tax_amount, total_amount, status, payment_status, order_type,
  created_at, updated_at
) VALUES 
  ('order-1111-1111-1111-111111111111', '11111111-1111-1111-1111-111111111111', 'table-3333-3333-3333-333333333333', 'ORD-001', '王小明', '0912345678', 260.00, 13.00, 273.00, 'preparing', 'unpaid', 'dine_in', NOW(), NOW()),
  ('order-2222-2222-2222-222222222222', '11111111-1111-1111-1111-111111111111', 'table-1111-1111-1111-111111111111', 'ORD-002', '李小華', '0987654321', 200.00, 10.00, 210.00, 'ready', 'paid', 'dine_in', NOW(), NOW()),
  ('order-3333-3333-3333-333333333333', '11111111-1111-1111-1111-111111111111', 'table-7777-7777-7777-777777777777', 'ORD-003', '張大同', '0923456789', 315.00, 15.75, 330.75, 'served', 'paid', 'dine_in', NOW(), NOW());

-- 6. 插入訂單項目
INSERT INTO order_items (
  id, order_id, product_id, product_name, quantity, unit_price, total_price, 
  status, created_at, updated_at
) VALUES 
  -- 訂單1的項目 (preparing)
  ('item-1111-1111-1111-111111111111', 'order-1111-1111-1111-111111111111', 'prod-1111-1111-1111-111111111111', '招牌牛肉麵', 1, 180.00, 180.00, 'preparing', NOW(), NOW()),
  ('item-2222-2222-2222-222222222222', 'order-1111-1111-1111-111111111111', 'prod-2222-2222-2222-222222222222', '滷肉飯', 1, 80.00, 80.00, 'preparing', NOW(), NOW()),
  
  -- 訂單2的項目 (ready)
  ('item-3333-3333-3333-333333333333', 'order-2222-2222-2222-222222222222', 'prod-3333-3333-3333-333333333333', '炒飯', 1, 120.00, 120.00, 'ready', NOW(), NOW()),
  ('item-4444-4444-4444-444444444444', 'order-2222-2222-2222-222222222222', 'prod-2222-2222-2222-222222222222', '滷肉飯', 1, 80.00, 80.00, 'ready', NOW(), NOW()),
  
  -- 訂單3的項目 (served)
  ('item-5555-5555-5555-555555555555', 'order-3333-3333-3333-333333333333', 'prod-0001-0001-0001-000000000001', '宮保雞丁', 1, 150.00, 150.00, 'served', NOW(), NOW()),
  ('item-6666-6666-6666-666666666666', 'order-3333-3333-3333-333333333333', 'prod-0002-0002-0002-000000000002', '糖醋排骨', 1, 160.00, 160.00, 'served', NOW(), NOW()),
  ('item-7777-7777-7777-777777777777', 'order-3333-3333-3333-333333333333', 'prod-0009-0009-0009-000000000009', '酸辣湯', 1, 60.00, 60.00, 'served', NOW(), NOW());

-- 7. 驗證載入結果
SELECT 
  'restaurants' as table_name, 
  COUNT(*) as count 
FROM restaurants 
WHERE id = '11111111-1111-1111-1111-111111111111'

UNION ALL

SELECT 
  'categories' as table_name, 
  COUNT(*) as count 
FROM categories 
WHERE restaurant_id = '11111111-1111-1111-1111-111111111111'

UNION ALL

SELECT 
  'products' as table_name, 
  COUNT(*) as count 
FROM products 
WHERE restaurant_id = '11111111-1111-1111-1111-111111111111'

UNION ALL

SELECT 
  'tables' as table_name, 
  COUNT(*) as count 
FROM tables 
WHERE restaurant_id = '11111111-1111-1111-1111-111111111111'

UNION ALL

SELECT 
  'orders' as table_name, 
  COUNT(*) as count 
FROM orders 
WHERE restaurant_id = '11111111-1111-1111-1111-111111111111'

UNION ALL

SELECT 
  'order_items' as table_name, 
  COUNT(*) as count 
FROM order_items 
WHERE order_id IN (
    SELECT id FROM orders WHERE restaurant_id = '11111111-1111-1111-1111-111111111111'
);
