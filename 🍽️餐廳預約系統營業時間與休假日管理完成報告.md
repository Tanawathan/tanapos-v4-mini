# ğŸ½ï¸ é¤å»³é ç´„ç³»çµ±ç‡Ÿæ¥­æ™‚é–“èˆ‡ä¼‘å‡æ—¥ç®¡ç†å®Œæˆå ±å‘Š

## ğŸ“‹ è¨­ç½®æ‘˜è¦

æ ¹æ“šæ‚¨çš„éœ€æ±‚ï¼Œæˆ‘å·²ç¶“å®Œæˆäº†é¤å»³é ç´„ç³»çµ±çš„ç‡Ÿæ¥­æ™‚é–“å’Œä¼‘å‡æ—¥ç®¡ç†åŠŸèƒ½é–‹ç™¼ï¼š

### âœ… å·²å®Œæˆçš„åŠŸèƒ½

1. **ç‡Ÿæ¥­æ™‚é–“è¨­å®š** â°
   - æ¯æ—¥ä¸‹åˆ 2:00 - æ™šä¸Š 9:00
   - å·²æ›´æ–°åˆ°è³‡æ–™åº«çš„ `business_hours` æ¬„ä½

2. **ç”¨é¤æ™‚é•·è¨­å®š** ğŸ½ï¸
   - 90åˆ†é˜ç”¨é¤æ™‚é–“
   - æœ€æ™šé ç´„æ™‚é–“ï¼šæ™šä¸Š 7:30

3. **é ç´„ç³»çµ±æ›´æ–°** ğŸ¤–
   - è‡ªå‹•æ¡Œå°åˆ†é…åŠŸèƒ½
   - ä¼‘å‡æ—¥æª¢æŸ¥æ©Ÿåˆ¶
   - æ™ºæ…§æ™‚æ®µç”Ÿæˆ

4. **ä¼‘å‡æ—¥ç®¡ç†UI** ğŸ—“ï¸
   - æ—¥æ›†å¼ç•Œé¢ç®¡ç†
   - é€±æœŸæ€§ä¼‘å‡æ—¥æ”¯æ´
   - ä¸€æ¬¡æ€§ä¼‘å‡æ—¥è¨­å®š

## ğŸ› ï¸ éœ€è¦åŸ·è¡Œçš„è³‡æ–™åº«è¨­ç½®

### æ­¥é©Ÿ 1: åœ¨ Supabase SQL ç·¨è¼¯å™¨ä¸­åŸ·è¡Œ

è«‹åœ¨ Supabase ç®¡ç†å¾Œå°çš„ SQL ç·¨è¼¯å™¨ä¸­åŸ·è¡Œä»¥ä¸‹èªå¥ï¼š

\`\`\`sql
-- 1. æ·»åŠ é ç´„è¨­å®šæ¬„ä½åˆ°restaurantsè¡¨
ALTER TABLE restaurants 
ADD COLUMN IF NOT EXISTS reservation_settings JSONB DEFAULT '{
  "meal_duration_minutes": 90,
  "last_reservation_time": "19:30", 
  "advance_booking_days": 30,
  "min_advance_hours": 2,
  "max_party_size": 12,
  "default_table_hold_minutes": 15
}'::jsonb;

-- 2. æ›´æ–°ç¾æœ‰é¤å»³çš„é ç´„è¨­å®š
UPDATE restaurants 
SET reservation_settings = '{
  "meal_duration_minutes": 90,
  "last_reservation_time": "19:30",
  "advance_booking_days": 30, 
  "min_advance_hours": 2,
  "max_party_size": 12,
  "default_table_hold_minutes": 15
}'::jsonb
WHERE id = 'a8fff0de-a2dd-4749-a80c-08a6102de734';

-- 3. å‰µå»ºä¼‘å‡æ—¥ç®¡ç†è¡¨
CREATE TABLE IF NOT EXISTS restaurant_holidays (
    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
    restaurant_id UUID REFERENCES restaurants(id) ON DELETE CASCADE,
    holiday_date DATE NOT NULL,
    holiday_name VARCHAR(100),
    is_recurring BOOLEAN DEFAULT FALSE,
    recurring_type VARCHAR(20), -- 'yearly', 'monthly', 'weekly'
    description TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    
    UNIQUE(restaurant_id, holiday_date)
);

-- 4. å‰µå»ºç´¢å¼•æå‡æŸ¥è©¢æ•ˆèƒ½  
CREATE INDEX IF NOT EXISTS idx_restaurant_holidays_date 
ON restaurant_holidays(restaurant_id, holiday_date);

-- 5. å‰µå»ºå‡½æ•¸æª¢æŸ¥æ˜¯å¦ç‚ºä¼‘å‡æ—¥
CREATE OR REPLACE FUNCTION is_holiday(rest_id UUID, check_date DATE)
RETURNS BOOLEAN AS $$
BEGIN
    RETURN EXISTS (
        SELECT 1 FROM restaurant_holidays 
        WHERE restaurant_id = rest_id 
        AND holiday_date = check_date
    );
END;
$$ LANGUAGE plpgsql;

-- 6. æ’å…¥ç¤ºç¯„ä¼‘å‡æ—¥ï¼ˆå¯é¸ï¼‰
INSERT INTO restaurant_holidays (restaurant_id, holiday_date, holiday_name, is_recurring, recurring_type, description)
VALUES 
    ('a8fff0de-a2dd-4749-a80c-08a6102de734', '2025-12-25', 'è–èª•ç¯€', true, 'yearly', 'è–èª•ç¯€å…¬ä¼‘'),
    ('a8fff0de-a2dd-4749-a80c-08a6102de734', '2025-01-01', 'å…ƒæ—¦', true, 'yearly', 'å…ƒæ—¦å…¬ä¼‘')
ON CONFLICT (restaurant_id, holiday_date) DO NOTHING;
\`\`\`

## ğŸ¯ ç³»çµ±åŠŸèƒ½èªªæ˜

### ğŸ“… ç‡Ÿæ¥­æ™‚é–“è¦å‰‡
- **ç‡Ÿæ¥­æ™‚é–“**ï¼šæ¯æ—¥ 14:00 - 21:00
- **ç”¨é¤æ™‚é•·**ï¼š90åˆ†é˜
- **æœ€æ™šé ç´„**ï¼š19:30 (ç¢ºä¿21:00å‰çµæŸç”¨é¤)
- **é ç´„é–“éš”**ï¼š30åˆ†é˜æ™‚æ®µ

### ğŸ—“ï¸ ä¼‘å‡æ—¥ç®¡ç†
- **ä¸å›ºå®šä¼‘å‡æ—¥**ï¼šä½¿ç”¨æ—¥æ›†ç•Œé¢éˆæ´»è¨­å®š
- **é€±æœŸæ€§ä¼‘å‡**ï¼šæ”¯æ´æ¯å¹´ã€æ¯æœˆã€æ¯é€±é‡è¤‡
- **é ç´„é˜»æ“‹**ï¼šä¼‘å‡æ—¥è‡ªå‹•é˜»æ­¢é ç´„
- **ç®¡ç†ç•Œé¢**ï¼šè¦–è¦ºåŒ–æ—¥æ›†ç®¡ç†

### ğŸ¤– æ™ºæ…§é ç´„åˆ†é…
- **è‡ªå‹•æ¡Œå°åˆ†é…**ï¼šæ ¹æ“šäººæ•¸å’Œåå¥½æ™ºæ…§é¸æ“‡
- **å®¹é‡å„ªåŒ–**ï¼šæå‡æ¡Œå°ä½¿ç”¨æ•ˆç‡
- **åå¥½åŒ¹é…**ï¼šVIPå€ã€çª—é‚Šã€å…’ç«¥å‹å–„ç­‰
- **ä¼‘å‡æ—¥æª¢æŸ¥**ï¼šè‡ªå‹•éæ¿¾ä¸å¯é ç´„æ—¥æœŸ

## ğŸ“± ä½¿ç”¨æ–¹å¼

### 1. ç®¡ç†ä¼‘å‡æ—¥
\`\`\`tsx
import RestaurantHolidayManager from './components/RestaurantHolidayManager';

// åœ¨ç®¡ç†é é¢ä¸­ä½¿ç”¨
<RestaurantHolidayManager />
\`\`\`

### 2. é ç´„æ™‚æ®µæŸ¥è©¢
\`\`\`javascript
// æœƒè‡ªå‹•éæ¿¾ä¼‘å‡æ—¥å’Œéç‡Ÿæ¥­æ™‚é–“
const slots = await ReservationService.getAvailableTimeSlots(
  restaurantId, 
  date, 
  partySize
);
\`\`\`

### 3. å‰µå»ºé ç´„
\`\`\`javascript
// è‡ªå‹•æª¢æŸ¥ä¼‘å‡æ—¥å’Œç‡Ÿæ¥­æ™‚é–“
const reservation = await ReservationService.createReservation(
  formData, 
  restaurantId
);
\`\`\`

## ğŸ‰ é æœŸæ•ˆæœ

åŸ·è¡Œè³‡æ–™åº«è¨­ç½®å¾Œï¼Œç³»çµ±å°‡å…·å‚™ï¼š

### âœ… ç‡Ÿæ¥­æ™‚é–“æ§åˆ¶
- åªåœ¨ 14:00-19:30 é–‹æ”¾é ç´„
- æ¯30åˆ†é˜ä¸€å€‹æ™‚æ®µ
- è‡ªå‹•è¨ˆç®—90åˆ†é˜ç”¨é¤æ™‚é–“

### âœ… ä¼‘å‡æ—¥ç®¡ç†
- æ—¥æ›†ç•Œé¢è¨­å®šä¼‘å‡æ—¥
- æ”¯æ´é€±æœŸæ€§ä¼‘å‡ï¼ˆè–èª•ç¯€ã€å…ƒæ—¦ç­‰ï¼‰
- ä¼‘å‡æ—¥è‡ªå‹•é˜»æ­¢é ç´„

### âœ… æ™ºæ…§é ç´„ç³»çµ±
- è‡ªå‹•æ¡Œå°åˆ†é…
- å®¹é‡å„ªåŒ–ç®—æ³•
- å®¢æˆ¶åå¥½åŒ¹é…

## ğŸ”„ å¾ŒçºŒæ­¥é©Ÿ

1. **åŸ·è¡ŒSQLè¨­ç½®** - åœ¨Supabaseä¸­åŸ·è¡Œä¸Šè¿°SQLèªå¥
2. **æ¸¬è©¦é ç´„åŠŸèƒ½** - é©—è­‰ç‡Ÿæ¥­æ™‚é–“å’Œä¼‘å‡æ—¥æ§åˆ¶
3. **æ•´åˆUIçµ„ä»¶** - å°‡ä¼‘å‡æ—¥ç®¡ç†å™¨åŠ å…¥ç®¡ç†é é¢
4. **ç”¨æˆ¶åŸ¹è¨“** - æ•™å°å¦‚ä½•ä½¿ç”¨æ—¥æ›†è¨­å®šä¼‘å‡æ—¥

## ğŸ“ æŠ€è¡“æ”¯æ´

å¦‚æœåœ¨è¨­ç½®éç¨‹ä¸­é‡åˆ°å•é¡Œï¼š

1. **SQLåŸ·è¡ŒéŒ¯èª¤** - æª¢æŸ¥Supabaseæ¬Šé™è¨­å®š
2. **åŠŸèƒ½æ¸¬è©¦** - ä½¿ç”¨æ¸¬è©¦è…³æœ¬é©—è­‰
3. **UIæ•´åˆ** - ç¢ºèªçµ„ä»¶å°å…¥è·¯å¾‘æ­£ç¢º

---

**é ç´„ç³»çµ±ç¾å·²æ”¯æ´æ‚¨çš„æ‰€æœ‰éœ€æ±‚ï¼šæ¯æ—¥2-9é»ç‡Ÿæ¥­ã€90åˆ†é˜ç”¨é¤ã€7:30æœ€æ™šé ç´„ã€å½ˆæ€§ä¼‘å‡æ—¥ç®¡ç†ï¼** ğŸš€
