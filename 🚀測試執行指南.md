# 🚀 TanaPOS V4-AI 測試執行指南

## 📋 測試準備

### 1. 確認系統狀態
```bash
# 執行系統驗證腳本
node validate-system.js
```

### 2. 確認環境變數
確保 `.env` 文件包含正確的 Supabase 設定：
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 3. 啟動開發伺服器
```bash
# 啟動 V4-AI 開發伺服器 (port 5174)
npm run dev
```

## 🧪 測試執行步驟

### 階段一：快速功能驗證
```bash
# 快速桌台管理測試 (約2-3分鐘)
npm run test:quick
```
這個測試會驗證：
- ✅ 桌台狀態循環 (Available → Seated → Dining → Payment-Pending → Cleaning → Available)
- ✅ 桌台篩選功能
- ✅ 桌台容量管理
- ✅ 響應式設計

### 階段二：完整端到端測試
```bash
# 執行所有端到端測試 (約10-15分鐘)
npm run test:e2e
```
這個測試會驗證：
- ✅ 完整餐廳營運流程 (從入座到結帳)
- ✅ 多桌台並行操作
- ✅ 錯誤處理與恢復機制
- ✅ 移動設備相容性

### 階段三：視覺化測試 (可選)
```bash
# 以視覺化模式執行測試，可觀看測試過程
npm run test:e2e:ui
```

### 階段四：除錯模式 (問題排查)
```bash
# 除錯模式，逐步執行測試
npm run test:e2e:debug
```

## 📊 測試報告查看

### 測試結果位置
- HTML 報告：`test-results/index.html`
- JSON 結果：`test-results/results.json`
- 截圖/錄影：`test-results/` 資料夾

### 查看測試報告
```bash
# 開啟 HTML 測試報告
npx playwright show-report
```

## 🎯 測試重點功能

### 1. 桌台管理系統
- **狀態管理**: 桌台在不同狀態間的正確轉換
- **篩選功能**: 按狀態篩選桌台的準確性
- **容量分配**: 根據客人數量自動分配合適桌台
- **響應式設計**: 在不同設備上的正確顯示

### 2. POS 點餐系統
- **桌台選擇**: 正確選擇和關聯桌台
- **產品添加**: 菜品加入購物車的流程
- **數量管理**: 產品數量的增減操作
- **客製化選項**: 特殊要求和備註功能
- **訂單確認**: 訂單資訊的準確傳遞

### 3. 訂單管理系統
- **狀態更新**: 訂單狀態的正確變更流程
- **資訊顯示**: 訂單詳細資訊的完整顯示
- **篩選排序**: 訂單列表的篩選和排序功能
- **即時更新**: 狀態變更的即時反映

### 4. 結帳系統
- **支付方式**: 現金和行動支付的處理
- **金額計算**: 服務費和找零的正確計算
- **收據生成**: 支付完成後的收據顯示
- **狀態同步**: 結帳後桌台狀態的正確更新

## 🔍 常見問題排查

### 測試失敗常見原因

1. **開發伺服器未啟動**
   ```bash
   # 確認伺服器運行在 port 5174
   npm run dev
   ```

2. **資料庫連線問題**
   - 檢查 `.env` 文件中的 Supabase 設定
   - 確認網路連線正常

3. **DOM 元素找不到**
   - 可能是頁面載入速度問題
   - 組件結構可能有變更

4. **時序問題**
   - 某些操作可能需要更多等待時間
   - 可以調整測試中的 `waitForTimeout` 值

### 除錯技巧

1. **使用 headed 模式觀看測試**
   ```bash
   npm run test:e2e:headed
   ```

2. **單獨執行特定測試**
   ```bash
   npx playwright test tests/table-management.test.ts
   ```

3. **查看詳細錯誤資訊**
   ```bash
   npx playwright test --reporter=list
   ```

## 📈 測試成功標準

### 基本通過標準
- ✅ 所有測試案例通過率 ≥ 90%
- ✅ 核心業務流程無失敗
- ✅ 響應時間 < 2秒
- ✅ 無嚴重錯誤或異常

### 高品質標準
- ✅ 所有測試案例通過率 = 100%
- ✅ 平均響應時間 < 1秒
- ✅ 支援多瀏覽器
- ✅ 移動設備完全相容

## 🎉 測試完成後的行動

### 如果測試全部通過
1. 系統已準備好進行更進階的功能開發
2. 可以考慮部署到測試環境
3. 開始進行使用者接受測試 (UAT)

### 如果測試有失敗
1. 查看測試報告了解失敗原因
2. 修復發現的問題
3. 重新執行測試直到全部通過
4. 更新測試案例以涵蓋新發現的場景

## 📞 支援與協助

如果在測試過程中遇到問題：

1. **查看測試報告**: `npx playwright show-report`
2. **檢查開發者工具**: 瀏覽器控制台的錯誤訊息
3. **查看伺服器日誌**: 開發伺服器的輸出訊息
4. **參考測試文檔**: 查看 `🧪V4-AI自動化測試腳本.md`

---

**祝您測試順利！** 🚀

*最後更新: 2025年8月4日*
